<!-- Admin round control partial â€” swapped via SSE -->
<div style="display: flex; justify-content: space-between; align-items: flex-start;">
  <div>
    <div style="font-size: 12px; font-weight: 600; color: #64748b; letter-spacing: 0.08em; text-transform: uppercase; margin-bottom: 8px;">
      Round Control
    </div>
    {% if state.round_number > 0 %}
    <div style="font-size: 22px; font-weight: 700; margin-bottom: 4px;">
      Round {{ state.round_number }} of {{ state.round_number + state.rounds_remaining }}
    </div>
    {% else %}
    <div style="font-size: 22px; font-weight: 700; margin-bottom: 4px;">
      Pre-Event
    </div>
    {% endif %}
    <div style="font-size: 13px; color: {% if state.status.value == 'round-active' and not state.timer_paused %}#22c55e{% elif state.timer_paused %}#f59e0b{% else %}#64748b{% endif %};">
      {% if state.status.value == 'round-active' and not state.timer_paused %}In progress
      {% elif state.timer_paused %}Paused
      {% elif state.round_number > 0 %}Between rounds
      {% else %}Waiting to start{% endif %}
    </div>
  </div>
  <span id="timer-display" style="font-family: 'JetBrains Mono', monospace; font-size: 42px; font-weight: 700; color: #e2e8f0;">--:--</span>
</div>

<div style="display: flex; gap: 10px; margin-top: 20px; flex-wrap: wrap;">
  {% if state.rounds_remaining > 0 %}
  <button id="advance-btn"
    hx-post="/api/admin/advance-round"
    hx-swap="none"
    onclick="confirmAdvance(event)"
    style="background: radial-gradient(circle at 75% 20%, rgba(255,255,255,0.15), transparent 50%), radial-gradient(circle at 80% 20%, #4ade80, #22c55e 50%, #16a34a); color: #0a0f1a; border: none; border-radius: 8px; padding: 10px 20px; font-weight: 600; font-size: 14px; cursor: pointer;">
    &#9654; Start Round {{ state.round_number + 1 }}
  </button>
  <!-- Confirm prompt (hidden, shown by JS) -->
  <div id="advance-confirm" style="display: none; align-items: center; gap: 8px;">
    <span style="font-size: 13px; color: #f59e0b;">Start Round {{ state.round_number + 1 }}? {{ counts.active }} attendees in pool.</span>
    <button id="advance-confirm-btn"
      hx-post="/api/admin/advance-round"
      hx-swap="none"
      style="background: radial-gradient(circle at 75% 20%, rgba(255,255,255,0.15), transparent 50%), radial-gradient(circle at 80% 20%, #4ade80, #22c55e 50%, #16a34a); color: #0a0f1a; border: none; border-radius: 8px; padding: 8px 16px; font-weight: 600; font-size: 13px; cursor: pointer;">
      Confirm
    </button>
    <button onclick="cancelAdvance()"
      style="background: #374151; color: #e2e8f0; border: none; border-radius: 8px; padding: 8px 16px; font-weight: 600; font-size: 13px; cursor: pointer;">
      Cancel
    </button>
  </div>
  {% endif %}

  {% if state.status.value == 'round-active' or state.timer_paused %}
  <button
    hx-post="/api/admin/pause"
    hx-vals='{"action": "{% if state.timer_paused %}resume{% else %}pause{% endif %}"}'
    hx-swap="none"
    style="background: #1e293b; color: #e2e8f0; border: 1px solid #374151; border-radius: 8px; padding: 10px 20px; font-weight: 600; font-size: 14px; cursor: pointer;">
    {% if state.timer_paused %}&#9654; Resume{% else %}&#9208; Pause{% endif %}
  </button>
  {% endif %}

  {% if state.round_number > 0 %}
  <button
    hx-post="/api/admin/undo-round"
    hx-confirm="Undo Round {{ state.round_number }}? This will roll back pairings and restore the previous round."
    hx-swap="none"
    style="background: transparent; color: #ef4444; border: 1px solid #7f1d1d; border-radius: 8px; padding: 10px 20px; font-weight: 600; font-size: 14px; cursor: pointer; margin-left: auto;">
    Undo Round {{ state.round_number }}
  </button>
  {% endif %}
</div>
